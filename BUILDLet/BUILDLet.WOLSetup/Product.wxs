<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">

  
  <!-- Include -->
  <?include ..\Version\InstallerInfo.wxi?>

  
  <!-- GUID -->
  <?define GUID_Product="{D56FBBFB-8D89-4233-9763-048BB7FF201D}"?>
  <?define GUID_UpgradeCode="{AFCA8C85-7CB9-44F9-9880-0C58F711B09C}"?>
  <?define GUID_ProductComponent="{EB131451-2E2A-4209-BD40-C2D02DD40216}"?> <!-- V1.0.5 Changed -->
  <?define GUID_Documents="{3C726715-3878-4664-A02F-959C79F96265}"?>
  <?define GUID_ConfigFile="{5B00CD26-AC1D-430A-A5D1-09887191665D}"?>
  <?define GUID_OldExeFile="{6245EE59-0EFB-41AA-B19A-A61B98BDA287}"?>
  

  <!-- Resources -->
  <?define Source_Readme="..\Resources\BUILDLet.WOLSetup\Readme.txt"?>
  <?define Source_License="..\Resources\BUILDLet.WOLSetup\License.txt"?>
  <?define Source_IconFile="..\BUILDLet.WOL\Resources\BUILDLet_WOL.ico"?>

  <!-- Source Files -->
  <?define Source_MainComponent="Sources\WOL.exe"?>

  
  <!-- Remove Files -->
  <?define Remove_ConfigFile="WOL.conf"?>
  <?define Remove_OldExeFile="BUILDLet.WOL.exe"?>


  <!-- Product -->
  <Product Id="$(var.GUID_Product)"
           UpgradeCode="$(var.GUID_UpgradeCode)"
           Manufacturer="$(var.Manufacturer)"
           Name="$(var.ProductName) $(var.ProductVersion)"
           Version="$(var.ProductVersion)"
           Language="1041" Codepage="932">

    <Package Id="*"
             Description="$(var.ProductName) $(var.ProductVersion) Installer"
             Comments="$(var.ProductComment)"
             InstallerVersion="200"
             Compressed="yes"
             Languages="1041" SummaryCodepage="932"
             InstallScope="perMachine" />

    <!-- MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." / -->
    <MediaTemplate CabinetTemplate="data{0}.cab" EmbedCab="yes" />

    <Feature Id="ProductFeature" Title="$(var.ProductName)" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
    </Feature>
    
  </Product>

  
  <!-- Directories -->
  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="ManufacturerFolder" Name="$(var.Manufacturer)">
          <Directory Id="WOLFolder" Name="$(var.NickName)">
            <Directory Id="INSTALLFOLDER" />
          </Directory>
        </Directory>
      </Directory>
      <Directory Id="DesktopFolder" Name="Desktop" />
    </Directory>
  </Fragment>

  
  <!-- Icon -->
  <Fragment>
    <Icon Id="WOL.ico" SourceFile="$(var.Source_IconFile)" />
  </Fragment>

  
  <!-- Components -->
  <Fragment>
    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">

      <!-- BUILDLet.WOL.exe -->
      <Component Id="ProductComponent" Guid="$(var.GUID_ProductComponent)">
        <File Source="$(var.Source_MainComponent)" KeyPath="yes">
          <Shortcut Id="shortcut" 
                    Name="$(var.NickName)" 
                    Directory="DesktopFolder" 
                    WorkingDirectory="INSTALLFOLDER" 
                    Icon="WOL.ico" 
                    Advertise="yes" />
        </File>
      </Component>

      
      <!-- Documents for WOL (Readme and License) -->
      <Component Id="Documents" Guid="$(var.GUID_Documents)" KeyPath="yes">
        <File Source="$(var.Source_Readme)" />
        <File Source="$(var.Source_License)" />
      </Component>
      
      
      <!-- Configuration File to be deleted -->
      <Component Id="ConfigFile" Guid="$(var.GUID_ConfigFile)">
        <RemoveFile Id="ConfigFile" On="uninstall" Name="$(var.Remove_ConfigFile)" />
      </Component>

      
      <!-- Old Executable File ("BUILDLet.WOL.exe") to be deleted -->
      <Component Id="OldExeFile" Guid="$(var.GUID_OldExeFile)">
        <RemoveFile Id="OldExeFile" On="uninstall" Name="$(var.Remove_OldExeFile)" />
      </Component>

      
    </ComponentGroup>
  </Fragment>

</Wix>
